---
title: "Literature data"
author: "jillashey"
date: "2023-05-10"
output: html_document
---

This script will plot the cummulative distribution of the peer-reviewed literature on **Astrangia poculata**. This data does not include dissertations, theses, etc. 

## Load packages 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggpubr)
library(cowplot)
library(gridExtra)
```

## Load lit data by year 
```{r}
lit <- read.csv("../data/LiteratureByYear.csv")

# Remove NAs
lit <- na.omit(lit)

# Add row for 2023 paper 
new_row <- data.frame(Year = 2023, PublicationNo. = 1)
lit <- rbind(lit, new_row)
```

## Plot lit data by year 
```{r}
lit_by_year <- ggplot(lit, aes(y = PublicationNo., x = Year)) +
  geom_bar(stat = "identity", position = "dodge", fill = "gray", color = "black", width = 1, size = 2) +
  theme_minimal() +
  ylab("Number of Publications\n") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)), limits = c(0, 6), breaks = seq(0,6,1)) +
  scale_x_continuous(breaks = seq(1925,2023,5)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 65,
                                   #vjust = 0.5,
                                   hjust= 1,
                                   size=24,
                                   colour = "black"),
        axis.title.x = element_text(size = 0),
        axis.text.y = element_text(size = 24, colour = "black"),
        axis.title.y = element_text(size = 28, face = "bold"),
        axis.line = element_line(colour = 'black', size = 1),
        axis.ticks.x = element_line(size = 1, color = "black"),
        axis.ticks.length = unit(0.5, "cm"),
        #plot.title = element_text(size = 100, hjust = 0.5),
        plot.margin = margin(3,3,3,3, "cm"))
lit_by_year

# Save plot 
ggsave("../output/Literature_By_Year.pdf", lit_by_year, width = 40, height = 15, units = c("in"))
ggsave("../output/Literature_By_Year.png", lit_by_year, width = 40, height = 15, units = c("in"))
```



## Load lit data by focal area
```{r}
lit_focal <- read.csv("../data/LiteratureByFocalArea.csv")

# Replace "Habitat" with "Habitat & Ecology"
lit_focal$Primary.Focal.Area <- gsub("Habitat", "Habitat & Ecology", lit_focal$Primary.Focal.Area)

lit_focal <- lit_focal %>%
  group_by(Primary.Focal.Area) %>%
  summarise(count = n()) %>%
  mutate(percentage = (count / sum(count)) * 100)
```

## Plot lit data by focal area 
```{r}
lit_by_area <- ggplot(lit_focal, aes(x="", y=count, fill=Primary.Focal.Area)) +
  geom_col(color = "black", linewidth = 1.2) +
  coord_polar("y", start=0) + 
  theme_void() +
  #geom_text(aes(label = paste0(round(percentage, 1), "%")), position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette = "Dark2") +
  theme_void() +
  labs(fill = "Focal Area") +
  geom_text(aes(x = 1.6, label = paste0(round(percentage, 1), "%")), position = position_stack(vjust = 0.5), size = 6.5) +
  theme(legend.position = "right", 
        legend.text = element_text(size = 20), 
        legend.title = element_text(size = 24))
lit_by_area

# Save plot 
ggsave("../output/Literature_By_FocalArea.pdf", lit_by_area, width = 20, height = 15, units = c("in"))
ggsave("../output/Literature_By_FocalArea.png", lit_by_area, width = 20, height = 15, units = c("in"))
```

## Arrange both plots into a single figure
```{r}
fig <- ggdraw() +
  draw_plot(lit_by_year, x = 0, y = 0.5, width = 1, height = 0.5) +
  draw_plot(lit_by_area, x = 0, y = 0, width = 0.5, height = 0.5) + 
  draw_plot_label(label = c("a", "b"), size = 20, x = c(0, 0), y = c(1, 0.5))


# Save plot 
ggsave("../output/Figures/Figure3.pdf", fig, width = 20, height = 15, units = c("in"))
ggsave("../output/Figures/Figure3.png", fig, width = 20, height = 15, units = c("in"))
```







